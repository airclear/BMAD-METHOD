## agent目标

最终目标是创建一个 AI 代理，它能自动化分析 Java Web 项目中不一致的代码风格和规范，然后生成一套特定的 AI 指南，以便让 AI 辅助工具能够生成符合这些项目规范的代码。

## 背景说明

我分享一些使用AI工具辅助编写代码的心得，重点是如何在已有项目背景下更准确地利用AI生成符合预期的代码。

背景
近期我接手了财务相关项目，由于团队尚未组建完成，为确保9月目标达成，需提前完成部分基础设计与开发工作。希望通过AI工具生成主要需求代码，搭建出业务流程框架，待新成员到岗后基于此进行联调与完善。

实际使用体验
我使用的是阿里旗下的一款IDE，其AI功能日益强大，但仍需大量人工引导与调教。由于对财务项目的代码结构、技术约束与隐性规范了解有限，完全依赖AI理解项目并生成理想代码是不可行的。

实际生成过程中，即使提供了较完整的需求（涉及多个模块、约15个页面，且需对接上下游系统），AI可进行任务拆解和分步实现，但仍存在以下问题：

1.  ​​数据表缺失​​：预期设计8张表，实际生成遗漏了3-4张；

2.  ​​代码分层错乱​​：项目实际为四层架构（Controller-Service-Domain-DAO），但AI按常见三层生成，导致代码位置、包路径错误；

3.  ​​对象转换混乱​​：不同层间对象（如Entity、DTO、VO）转换未明确说明时，AI无法准确处理，甚至出现反向引用；

4.  ​​模块误解​​：AI通过模块名称推测定位，但财务项目模块命名歧义较大（如“应付”模块实际包含全部业务代码），导致代码生成到错误模块；

5.  ​​编译失败​​：生成代码存在依赖错误、循环引用等问题，无法通过编译。

尽管该IDE支持“仓库维基”（可分析整个代码库形成结构化知识）和“长期记忆”功能，但AI在实际代码生成中仍未充分利用这些信息，生成结果与预期差距较大。

AI的优势与短板
∙
​​优势​​：对具体功能点的实现非常准确。如提供清晰的表结构、流程和需求描述，AI能生成高质量的接口和经典分层代码（不考虑规范时）。

∙
​​短板​​：缺乏对项目特定技术栈、规范与风格的理解。不同项目在技术版本、分层架构、编码约定等方面差异显著，AI如未经明确约束，会像“新人”一样按自己的风格实现，导致代码不符合项目长期要求。

解决策略：将AI视为需严格指导的新人
为确保AI生成代码符合预期，需像指导新人或外包一样提供清晰规范与示例：

1.  ​​提供明确规范与约束​​：

∙
项目结构：Maven模块、包结构划分及作用；

∙
技术栈：Java版本、依赖库（Spring、MyBatis等）及其版本、数据库与中间件版本；

∙
编码风格：分层规范、对象转换规则（如DO→DTO）、统一异常处理、Swagger注解要求等；

∙
任务示例：已有功能代码作为参考，明确实现边界。

2.  ​​以文档形式传递上下文​​：

∙
使用Markdown编写规范文档（避免图片，以文字或图表描述）；

∙
将文档纳入代码仓库，供AI读取学习；

∙
结合IDE的Rules或长期记忆功能固化规范，减少重复说明。

3.  ​​模型选择与任务分工​​：

∙
技术设计、调研探讨使用GPT-4（如GitHub Copilot或网页版）；

∙
代码生成与任务执行使用Claude系列模型；

∙
固定常用模型以建立默契，提高生成一致性。

4.  ​​持续优化与精调​​：

∙
根据生成结果反复调整规范描述与提示词；

∙
确保指令简洁明确，契合模型特性。
